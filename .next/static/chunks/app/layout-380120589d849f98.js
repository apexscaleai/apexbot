(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{5800:function(e,t,s){Promise.resolve().then(s.bind(s,1364)),Promise.resolve().then(s.bind(s,2298)),Promise.resolve().then(s.t.bind(s,4742,23)),Promise.resolve().then(s.t.bind(s,7960,23))},1364:function(e,t,s){"use strict";s.d(t,{MicrophoneContextProvider:function(){return i}});var n=s(7437),a=s(2265);let r=(0,a.createContext)(void 0),i=e=>{let{children:t}=e,[s,i]=(0,a.useState)(null),[o,u]=(0,a.useState)(),[l,c]=(0,a.useState)(),[d,p]=(0,a.useState)(),_=async()=>{i(0);try{let e=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,volume:1,echoCancellation:!0,noiseSuppression:!1,latency:0}}),t=new AudioContext,s=t.createMediaStreamSource(e),n=t.createScriptProcessor(4096,1,1);u(s),c(t),p(n),i(1)}catch(e){console.error(e),"NotFoundError"!==e.name&&"NotAllowedError"!==e.name&&console.log(e.name)}},h=(0,a.useCallback)(()=>{o&&d&&l&&(o.connect(d),d.connect(l.destination),i(2))},[d,l,o]);return(0,n.jsx)(r.Provider,{value:{microphone:o,startMicrophone:h,setupMicrophone:_,microphoneState:s,microphoneAudioContext:l,setMicrophoneAudioContext:c,processor:d},children:t})}},2298:function(e,t,s){"use strict";s.d(t,{VoiceBotContextProvider:function(){return y},aI:function(){return i},Gn:function(){return g},Ct:function(){return f},Z$:function(){return S},jq:function(){return v}});var n,a,r,i,o=s(7437),u=s(2265);let l="start_listening",c="start_speaking",d="start_sleeping",p="add_message",_="set_attach_params_to_copy_url",h="add_behind_scenes_event",m=(e,t)=>{switch(t.type){case l:return{...e,status:i.LISTENING,sleepTimer:0};case"start_thinking":return{...e,status:i.THINKING};case c:return{...e,status:i.SPEAKING,sleepTimer:0};case d:return{...e,status:i.SLEEPING};case"increment_sleep_timer":return{...e,sleepTimer:e.sleepTimer+1};case"reset_sleep_timer":return{...e,sleepTimer:0};case p:return{...e,messages:[...e.messages,t.payload]};case _:return{...e,attachParamsToCopyUrl:t.payload};case h:return{...e,behindTheScenesEvents:[...e.behindTheScenesEvents,t.payload]};default:return e}};(n=r||(r={})).SETTINGS_APPLIED="SettingsApplied",n.AGENT_AUDIO_DONE="AgentAudioDone",n.USER_STARTED_SPEAKING="UserStartedSpeaking",n.AGENT_STARTED_SPEAKING="AgentStartedSpeaking",n.CONVERSATION_TEXT="ConversationText",n.END_OF_THOUGHT="EndOfThought";let f=e=>S(e)||g(e),E=e=>void 0!==e.tts_latency,S=e=>void 0!==e.user,g=e=>void 0!==e.assistant;(a=i||(i={})).LISTENING="listening",a.THINKING="thinking",a.SPEAKING="speaking",a.SLEEPING="sleeping",a.NONE="";let N={status:"",sleepTimer:0,messages:[],attachParamsToCopyUrl:!0,behindTheScenesEvents:[]},T=(0,u.createContext)(void 0);function v(){let e=(0,u.useContext)(T);if(!e)throw Error("useVoiceBot must be used within a VoiceBotProvider");return e}function y(e){let{children:t}=e,[s,n]=(0,u.useReducer)(m,N),a=(0,u.useRef)(!1),r=(0,u.useRef)(s.status);(0,u.useEffect)(()=>{r.current=s.status},[s.status]);let i=(0,u.useCallback)(()=>{a.current=!0,n({type:d})},[]),v=(0,u.useCallback)(e=>{n({type:p,payload:e})},[]),y=(0,u.useCallback)(e=>{n({type:h,payload:e})},[]),C=(0,u.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||"sleeping"!==s.status)&&n({type:c})},[s.status]),I=(0,u.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||"sleeping"!==s.status)&&n({type:l})},[s.status]),b=(0,u.useCallback)(()=>{"sleeping"===s.status?I(!0):i()},[s.status,I,i]),P=(e,t)=>g(t)&&S(e),k=(0,u.useMemo)(()=>{let e=s.messages.filter(f),t=s.messages.filter(E),n=[];return e.forEach((e,s,a)=>{let r=a[s-1];if(r&&P(e,r)){let e=t.shift();e&&n.push(e)}if(n.push(e),g(e)&&s===a.length-1){let e=t.shift();e&&n.push(e)}}),n},[s.messages]),A=(0,u.useCallback)(e=>{n({type:_,payload:e})},[]),G=(0,u.useMemo)(()=>({...s,isWaitingForUserVoiceAfterSleep:a,displayOrder:k,addVoicebotMessage:v,addBehindTheScenesEvent:y,startSpeaking:C,startListening:I,startSleeping:i,toggleSleep:b,setAttachParamsToCopyUrl:A}),[s,I,C,i,b,A,k,v,y]);return(0,o.jsx)(T.Provider,{value:G,children:t})}},7960:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_e8ce0c', '__Inter_Fallback_e8ce0c'",fontStyle:"normal"},className:"__className_e8ce0c"}}},function(e){e.O(0,[540,971,117,744],function(){return e(e.s=5800)}),_N_E=e.O()}]);